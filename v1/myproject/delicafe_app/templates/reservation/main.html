{% extends "base/base.html" %}

{% block title %}予約{% endblock %}

{% block main_padding %}pt-24{% endblock %}

{% block content %}
{% include 'base/header.html' %}
<div class="flex flex-col items-center mx-auto w-full max-w-xl">

    <div class="flex flex-col items-center mb-10 w-full">
      <a
        type="submit"
        class="bg-green-500 text-white text-center p-2 rounded-md w-32 mb-5"
        href="{% url 'user:reservation_calendar' %}"
      >
      座席予約
      </a>

      <div class="w-full border bg-gray-100 rounded-md">
        {% if reservations %}
          {% for reservation in reservations %}
          <div class="flex w-full border-b">
            <div class="w-1/3">予約日時：</div>
            <div class="w-2/3 text-center">
              {{ reservation.date }} {{ reservation.start_time }} ~ {{ reservation.end_time }}
            </div>
          </div>

          <div class="flex w-full">
            <div class="w-1/3">座席番号：</div>
              <div class="w-2/3 text-center">{{ reservation.seat_id }}</div>
            </div>
          {% endfor %}
        {% else %}
          <div class="text-center">
            予約がありません
          </div>
        {% endif %}
      </div>
  </div>
      
    <div class="flex flex-col items-center h-auto w-full">
      <a
        type="submit"
        class="bg-green-500 text-white text-center p-2 rounded-md w-32 mb-5"
        href="{% url 'user:reservation_pre_order' %}"
      >
      事前オーダー
      </a>
      <p class="text-sm text-red-500">※事前オーダーで商品価格10%off</p>

      <div class="w-full border bg-gray-100 rounded-md">
        {% if cart_items %}
          {% for cart_item in cart_items %}
          <div class="flex items-center w-full border-b p-2">
            <div class="w-3/4">{{ cart_item.product.name }}</div>
            <div class="border-l w-2/5 text-center">{{ cart_item.quantity }}点</div>
            <div class="flex items-center w-2/5">
              <div class="text-sm border-l w-1/2 text-center" style= "text-decoration: line-through double; text-decoration-color: #EF4444;" >
                ¥{{ cart_item.total_price }}
              </div>
              <div class="w-1/2 text-center">
                ¥{{ cart_item.total_discount_price }}
              </div>
            </div>
            <div class="border-l flex justify-center items-center w-1/5">
              <form method="post" action="{% url 'user:delete_cart_item' cart_item.id %}">
                {% csrf_token %}
                <button 
                  type="submit"
                  class="text-sm w-[40px] bg-gray-300 border rounded-md"
                >削除</button>
              </form>
            </div>
          </div>
          {% endfor %}
        {% else %}
          <div class="w-full text-center">オーダーはありません</div>
        {% endif %}
      </div>
      {% with back_url="user:home" next_text="確認" next_url="user:reservation_confirm" %}
        {% include 'base/footer.html' %}
      {% endwith %}
    </div>
</div>
{% endblock%}